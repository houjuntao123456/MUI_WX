<!DOCTYPE html>
<html lang="en">

<head>
	<meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
	<meta name="viewport"
		content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
	<script src="../js/jquery.min.js"></script>
	<script src="../js/jquery.cookie.js"></script>
	<link rel="stylesheet" href="../mui/css/mui.min.css">
	<link rel="stylesheet" href="../css/Animate.css">
	<!-- <script src="../mui/js/mui.min.js"></script> -->
	<script src="../mui/js/muiR.js"></script>
	<script src="../js/hidden-titile.js"></script>
	<script src="../js/vconsole.js"></script>
	<title>快照</title>
	<style>
		.mui-table-view .mui-media-object {
			line-height: 80px;
			max-width: 80px;
			height: 80px;
			border-radius: 10px;
		}

		.mui-table-view .mui-media-object.mui-pull-left {
			margin-right: 0px;
			margin-top: 10px;
		}

		.mui_row {
			text-align: center;
			font-size: 16px;
		}

		.mui_row_color {
			font-size: 14px;
			color: #423C3C;
		}

		.mui-table-view-cell.mui-collapse .mui-table-view .mui-table-view-cell {
			padding: 10px;
		}

		.mui-table-view-cell.mui-collapse .mui-table-view .mui-table-view-cell:after {
			left: 0;
		}

		.mui-table-view-cell.mui-collapse .mui-table-view {
			margin-top: 0px;
		}

		.mui-table-view-cell.mui-collapse .mui-table-view .mui-table-view-cell:after {
			background-color: #e0e0e2;
		}

		.mui-table-view:after {
			background-color: #e0e0e2;
		}

		#picture {
			background-color: rgba(0, 0, 0, 0.5);
			position: fixed;
			width: 100%;
			height: 100%;
			z-index: 999;
			top: 0px;
		}

		.hide {
			display: none;
		}
	</style>
</head>

<body>
	<!--  头部-->
	<header class="mui-bar mui-bar-nav mui-bar-nav-bg" style="background-color:#007aff">
		<a href="javascript:history.go(-1)" class="mui-icon mui-icon-back" style="color:#fff;"></a>
		<h1 class="mui-title" style="color:#fff;">快照</h1>
	</header>
	<!-- 内容 -->
	<div class="mui-content">
		<div class="hide" id="picture">
			<div class="mui-row" style="margin-top:10px;margin-left:8px;">
				<span class="mui-icon mui-icon-close" style="font-size: 35px;color: white;"
					onclick="close_img()"></span>
			</div>
			<div style="width: 90%; margin-left:auto; margin-right:auto;margin-top: 15%;">
				<img class="animated rotateIn" id="picture_img" src="" alt="" style="width: 100%;border-radius: 10px;">
			</div>
		</div>
		<!-- 快照 -->
		<div id="snapshot">
			<div id="pullrefresh" class=" mui-scroll-wrapper " style="overflow:hidden;top: 44px;">
				<div class="mui-scroll">
					<!--数据列表-->
					<ul class="mui-table-view" id="member_data">
						<!-- mui-table-view-chevron-->
						<!-- 里面详细内容 -->
						<!-- <li class="mui-table-view-cell mui-collapse">
							<a class="mui-navigate-right" href="#" id="ppppppp"
								style="border-bottom: 1px dashed #ccc;"><span>
									<div style="height:30px;line-height: 30px; margin-right:25px;">
										<span style="font-size:14px;float:left ;color: rgb(102, 97, 97);">订单号:</span>
										<span
											style="font-size:14px;float: left;color: rgb(102, 97, 97);">XDXS0005037</span>

										件数
										<div style="font-size:14px;float: right;color: rgb(180, 175, 175);">
											<span>共</span>
											<span>1</span>
											<span>件商品</span>
										</div>
									</div>
									时间
									<div style="height:30px;line-height: 30px; margin-right:25px;">
										<span style="font-size:14px;float:left ;color: rgb(102, 97, 97);">订单时间</span>
										<div style="font-size:14px;float: right;color: rgb(180, 175, 175);">
											<span>2018-12-09 12:00"00</span>
										</div>
									</div>
									现代希色
									<div style="height:30px;line-height: 30px;margin-right:25px;">
										<span style="font-size:14px;float: left;color: rgb(102, 97, 97);">现代希色</span>
										价钱
										<div style="float: right;color:red;">
											<span>￥</span>
											<span>1439.00</span>
										</div>
									</div>
									导购
									<div style="height:30px;line-height: 30px;margin-right:25px;">
										<span style="font-size:14px;float: left;color: rgb(102, 97, 97);">导购</span>
										<div style="float: right;color:red;">
											<span>李云龙</span>
										</div>
									</div>
							</a>
							<div class="mui-collapse-content" style="text-align:center;">
								<ul class="mui-table-view">
									<li class="mui-table-view-cell mui-media" style="padding-left: 15px;">
										<a href="javascript:;">
											<img class="mui-media-object mui-pull-left" src="../images/suoke.jpg">
											<div class="mui-media-body" style="text-align:left;">
												<div class='mui-ellipsis mui-row'>
													<div class="mui-col-xs-5 mui-col-sm-5 mui_row">名称:</div>
													<div class="mui-col-xs-7 mui-col-sm-7 mui_row_color">交多少</div>
												</div>
												<div class='mui-ellipsis mui-row'>
													<div class="mui-col-xs-5 mui-col-sm-5 mui_row">件数:</div>
													<div class="mui-col-xs-7 mui-col-sm-7 mui_row_color">3件</div>
												</div>
												<div class='mui-ellipsis mui-row'>
													<div class="mui-col-xs-5 mui-col-sm-5 mui_row">颜色:</div>
													<div class="mui-col-xs-7 mui-col-sm-7 mui_row_color">红色</div>
												</div>
												<div class='mui-ellipsis mui-row'>
													<div class="mui-col-xs-5 mui-col-sm-5 mui_row">尺码:</div>
													<div class="mui-col-xs-7 mui-col-sm-7 mui_row_color">2xl</div>
												</div>
											</div>
											<button style=" position: relative;top:-30px;left: -133px;font-size:13px;">更换图片</button>
										</a>
									</li>
								</ul>
							</div>
						</li> -->
						<!--数据列表-->
				</div>
			</div>

		</div>
</body>
<!-- 快照 -->
<script>
	var count = 0;
	// 分的条数
	var limit_num = 10;
	// 获取传过来的参数
	var loc = location.href;
	var n1 = loc.length;
	var n2 = loc.indexOf('=');
	var idd = decodeURI(loc.substr(n2 + 1, n1 - n2));
	// idd = 13915668738;
	//可多次调用
	mui("#pullrefresh").pullRefresh({
		up: {
			contentrefresh: '正在加载...',
			callback: pullupRefresh,
			auto: true
		},
	})
	/**
	 * 下拉刷新具体业务实现
	 */
	function pulldownRefresh() { }
	/**
	 * 上拉加载具体业务实现
	 */
	// 重新开启加载
	// mui('#pullrefresh').pullRefresh().refresh(true);
	// 分页计数


	function pullupRefresh() {
		mui.post('/index.php/UserlistMemberdata/', {
			// 1233
			code: idd,
			page: ++count,
			limit: limit_num
		}, function (data) {
			if (data.code == 200) {
				// 服务器返回响应，根据响应结果，分析是否登录成功；
				setTimeout(function () {
					mui('#pullrefresh').pullRefresh().endPullupToRefresh((count > (data.data.snapshot.length / limit_num))); //参数为true代表没有更多数据了。
					var table = document.getElementById("member_data")
					for (i = 0; i < data.data.snapshot.length; i++) {
						// 订单名称
						data.data.snapshot[i].sname= (data.data.snapshot[i].sname=="") || (data.data.snapshot[i].sname == null) || (data.data.snapshot[i].sname == undefined)?"": data.data.snapshot[i].sname;		


						var li = document.createElement('li');
						li.className = 'mui-table-view-cell mui-collapse mui-active';
						li.style = "border-bottom: 1px solid #ececed";
						li.innerHTML = '<a class="mui-navigate-right" href="#" tap="xing(this)" name="' + data.data.snapshot[i].code +
							'" name2="' + data.data.snapshot[i].operate_name + '"  time="' + data.data.snapshot[i].time + '" style="background: #fff;border-bottom: 1px dashed #ccc;"><span>' +
							// 订单号
							' <div style="height:30px;line-height: 30px; margin-right:40px;">' +
							' <span style="font-size:14px;float:left ;color: rgb(102, 97, 97);">订单号:</span>' +
							' <span style="font-size:14px;float: left;color: rgb(102, 97, 97);">' + data.data.snapshot[i].code +
							'</span>' +
							' <div style="font-size:14px;float: right;color: rgb(180, 175, 175);">' +
							' <span>共</span>' +
							' <span>' + data.data.snapshot[i].number + '</span>' +
							' <span>件商品</span>' +
							' </div>' +
							' </div>' +
							// 订单时间
							' <div style="height:30px;line-height: 30px; margin-right:40px;">' +
							' <span style="font-size:14px;float:left ;color: rgb(102, 97, 97);">订单时间</span>' +
							' <div style="font-size:14px;float: right;color: rgb(180, 175, 175);">' +
							' <span>' + data.data.snapshot[i].time + '</span>' +
							' </div>' +
							' </div>' +
							// 购买金额
							' <div style="height:30px;line-height: 30px;margin-right:40px;font-size:14px;">' +
							' <span style="font-size:14px;float: left;color: rgb(102, 97, 97);">' + data.data.snapshot[i].sname +
							'</span>' +
							' <div style="float: right;color:red;">' +
							' <span>￥</span>' +
							' <span>' + data.data.snapshot[i].money + '</span>' +
							' </div>' +
							' </div>' +
							// 导购
							' <div style="height:30px;line-height: 30px;margin-right:40px;font-size:14px;">' +
							' <span style="font-size:14px;float: left;color: rgb(102, 97, 97);">' + '导购' +
							'</span>' +
							' <div style="float: right;color:red;">' +
							' <span>' + data.data.snapshot[i].operate_name + '</span>' +
							' </div>' +
							' </div>' +
							' </a>' +
							' <div class="mui-collapse-content" style="text-align:center;">' +
							' <ul class="mui-table-view" id="' + data.data.snapshot[i].code + '">' +
							' </ul>' +
							' </div>'
						//style="background-color:#EEE;"
						table.appendChild(li);
						xing(data.data.snapshot[i].code)
					}
				}, 1000);
			}
		}, 'json');
	}

	mui('.mui-scroll-wrapper').scroll({
		indicators: false, //是否显示滚动条
	});
	function xing(code) {
		mui.post('/index.php/UserlistSellinginfo/', {
			ordercode: code
		}, function (data) {
			//服务器返回响应，根据响应结果，分析是否登录成功；
			if (data.code == 200) {
				if (data.data.count == 0) {
					document.getElementById(code).innerHTML = "<h3 style=\"text-align:center;\">暂无订单详情!!!</h3>"
				}
				for (i = 0; i < data.data.data.length; i++) {
					data.data.data[i].photo = (data.data.data[i].photo == "" || data.data.data[i].photo == null || data.data.data[i].photo == 'undefined') ? '../images/suoke.jpg' : data.data.data[i].photo;
					data.data.data[i].gname = (data.data.data[i].gname == "" || data.data.data[i].gname == null || data.data.data[i].gname == 'undefined') ? '' : data.data.data[i].gname;
					data.data.data[i].number = (data.data.data[i].number == "" || data.data.data[i].number == null || data.data.data[i].number == 'undefined') ? '' : data.data.data[i].number;
					data.data.data[i].color = (data.data.data[i].color == "" || data.data.data[i].color == null || data.data.data[i].color == 'undefined') ? '' : data.data.data[i].color;
					data.data.data[i].sizes = (data.data.data[i].sizes == "" || data.data.data[i].sizes == null || data.data.data[i].sizes == 'undefined') ? '' : data.data.data[i].sizes;
					data.data.data[i].frenum = (data.data.data[i].frenum == "" || data.data.data[i].frenum == null || data.data.data[i].frenum == 'undefined') ? '' : data.data.data[i].frenum;
					// data.data.data[i].photo = 'http://i1.sinaimg.cn/ent/d/2008-06-04/U105P28T3D2048907F326DT20080604225106.jpg';
					var table2 = document.getElementById(code);
					var li2 = document.createElement('li');
					li2.className = "mui-table-view-cell mui-media ";
					li2.style = 'padding：0 0;';
					li2.innerHTML = '<li style="padding:0;">'
						+ '<a href="javascript:;">'
						+ '<img class="mui-media-object mui-pull-left mui_table_view_cell_img" src="' + data.data.data[i].photo + '">'
						+ '<div class="mui-media-body" style="text-align:left;color: rgb(102, 97, 97);">'
						+ '<div class="mui-row" style="line-height:25px;">'
						+ '<div class="mui-col-xs-5 mui-col-sm-5 mui_row">货号:</div>'
						+ '<div class="mui-col-xs-6 mui-col-sm-6 mui_row_color">' + data.data.data[i].frenum + '</div>'
						+ '</div>'
						+ '<div class="mui-row" style="line-height:25px;">'
						+ '<div class="mui-col-xs-5 mui-col-sm-5 mui_row">名称:</div>'
						+ '<div class="mui-col-xs-6 mui-col-sm-6 mui_row_color">' + data.data.data[i].gname + '</div>'
						+ '</div>'
						+ '<div class="mui-row" style="line-height:25px;">'
						+ '<div class="mui-col-xs-5 mui-col-sm-5 mui_row">件数:</div>'
						+ '<div class="mui-col-xs-6 mui-col-sm-6 mui_row_color">' + data.data.data[i].number + '件</div>'
						+ '</div>'
						+ '<div class="mui-row" style="line-height:25px;">'
						+ '<div class="mui-col-xs-5 mui-col-sm-5 mui_row">颜色:</div>'
						+ '<div class="mui-col-xs-6 mui-col-sm-6 mui_row_color">' + data.data.data[i].color + '</div>'
						+ '</div>'
						+ '<div class="mui-row" style="line-height:25px;">'
						+ '<div class="mui-col-xs-5 mui-col-sm-5 mui_row">尺码:</div>'
						+ '<div class="mui-col-xs-6 mui-col-sm-6 mui_row_color">' + data.data.data[i].sizes + '</div>'
						+ '</div>'
						+ '</div>'
						// <button style=" position: relative;top:-30px;left: -133px;font-size:13px;">更换图片</button>
						+ '</a>'
						+ '</li>'
					table2.appendChild(li2);
				}
			}
		}, 'json');
	}


</script>

<script>
	var picture = document.getElementById("picture");
	var picture_img = document.getElementById("picture_img");
	mui(".mui-table-view").on('tap', '.mui_table_view_cell_img', function () {
		//获取id
		// var id = this.getAttribute("id");
		picture_img.src = this.src;
		close_img();
	})

	function close_img() {
		if (picture.classList.contains("hide")) {
			// true 隐藏 移除隐藏
			picture.classList.remove("hide");
			// 添加动画
			picture_img.classList.remove('bounceOut');
			picture_img.classList.add('rotateIn');

		} else {
			// false 显示 添加隐藏
			picture_img.classList.remove('rotateIn');
			picture_img.classList.add('bounceOut')
			setTimeout(function () {
				picture.classList.add("hide");
			}, 1000)
		}

	}

</script>

</html>