<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta http-equiv="X-UA-Compatible" content="ie=edge">
	<link rel="stylesheet" href="../mui/css/mui.css">
	<script src="../mui/js/mui.js"></script>
	<script src="../js/vconsole.js"></script>
	<script src="../js/hidden-titile.js"></script>
	<link rel="stylesheet" href="../mui/css/mui.dtpicker.css">
	<script src="../mui/js/mui.dtpicker.js"></script>
	<link rel="stylesheet" href="../mui/css/mui.picker.min.css">
	<script src="../mui/js/mui.picker.min.js"></script>
	<link rel="stylesheet" href="../css/Animate.css">
	<link rel="stylesheet" href="../css/wx_con_group.css">
	<script src="../js/jquery.min.js"></script>
	<script src="../js/loading.js"></script>
	<link rel="stylesheet" href="../css/loading.css">
	<title>精准营销</title>
</head>
<style>
	.mui-off-canvas-left,
	.mui-off-canvas-right {
		width: 100%;
	}

	body {
		background-color: #fdfeff;

	}

	.group_tj {
		padding-top: 3px;
		padding-bottom: 10px;
		margin-top: 10px;
		width: 97%;
		margin-left: auto;
		margin-right: auto;
		border-radius: 5px;
		box-shadow: #cecbcb 0px 0px 5px;
		-webkit-box-shadow: #cecbcb 0px 0px 5px;
		-moz-box-shadow: #cecbcb 0px 0px 5px;
		background-color: #fdfeff;
	}

	.group_sx {
		font-size: 10px;
		width: 95%;
		margin-left: auto;
		margin-right: auto;
		padding-bottom: 4px;

	}

	.group_show {
		/* padding-top: 20px;
		border-bottom: 0px; */
		border: 1px solid #ecebeb;
		margin: 15px;
	}

	.group_show legend {
		font-size: 17px;
		font-family: fantasy;
		text-align: center;
		padding: 10px;
	}

	/* 标签样式 */
	.RadioStyle input,
	.checkboxStyle input {
		display: none
	}

	.checkboxStyle label {
		/* border: 1px solid #00a4ff; */
		padding: 2px 5px 2px 5px;
		line-height: 28px;
		min-width: 75px;
		text-align: center;
		float: left;
		margin: 0px;
		margin-left: 5px;
		margin-bottom: 5px;
		border-radius: 5px;
		font-size: 14px;
		background: #faf6f6;

	}

	.checkboxStyle input:checked+label {
		color: #00a4ff;
		border-radius: 10px;
		background: #d4e5f6;
		font-size: 14px;
	}

	.RadioStyle label {
		border: 1px solid #00a4ff;
		padding: 2px 10px 2px 10px;
		line-height: 23px;
		min-width: 60px;
		text-align: center;
		margin-left: 10px;
		margin-bottom: 5px;
		float: left;
		margin-top: 5px;
		border-radius: 4px;
		color: #6c6c6f;
		font-size: 14px;
	}

	.RadioStyle input:checked+label {
		background: url(../images/ico_checkon.svg) no-repeat right bottom;
		background-size: 25px 25px;
		background-color: #d4e5f6;
		color: #00a4ff
	}

	p>span {
		word-break: break-all;
	}

	.inpu_textarea {
		margin: 0px;
		padding: 0px;
		font-size: 10px;
	}

	.animated {
		animation-duration: 1.5s;
	}

	.jsdkaf {
		overflow: hidden;
		/*自动隐藏文字*/
		text-overflow: ellipsis;
		/*文字隐藏后添加省略号*/
		white-space: nowrap;
		-webkit-line-clamp: 1;
		/*想要显示的行数*/
		-webkit-box-orient: vertical;
		padding-left: 30px;
		padding-right: 30px;
	}

	/* 标签样式 */
</style>

<body>

	<!-- 侧滑导航根容器 -->
	<!-- 手势动作 mui-draggable -->
	<div class="mui-off-canvas-wrap   mui-slide-in mui-content">
		<!-- 主页面容器 -->
		<div class="mui-inner-wrap" style="background-color: #fff;">
			<!-- 菜单容器 -->
			<aside class="mui-off-canvas-right">
				<header class="mui-bar mui-bar-nav mui-bar-nav-bg" style="background-color:#007aff;">
					<a class="mui-icon mui-icon-back" style="color:white;" id="close_moban"></a>
					<h1 class="mui-title" style="color:white;">筛选模板</h1>
				</header>
				<div class="mui-scroll-wrapper" style="background-color: #fff;top: 44px;">
					<div class="mui-scroll" id="scroll_height" style="padding-bottom: 65px;">
						<div class="cont" style="width: 100%;">
							<!--  <div class="biz_title">
                                <h2>发展历程</h2>
                                <p>CONMPANY HISTORY</p>
                            </div> -->
							<div class="biz_timtline-box">
								<div class="biz_timeline" id="biz_timeline_moban">
									<!-- <div class="biz-timeline-box  clearfix animated">
										<div class="biz_timeline-time">2013.02</div>
										<div class="biz_timeline-node"></div>
										<div class="biz_timeline-eventbox">
											<div class="biz_timeline-event">公司成立</div>
										</div>
									</div> -->
								</div>
								<div class="biz_longString"></div>
							</div>
						</div>
					</div>
				</div>
			</aside>
			<!-- 主页面标题 -->
			<!--  头部-->
			<header class="mui-bar mui-bar-nav mui-bar-nav-bg" style="background-color:#007aff;">
				<a class="mui-icon mui-icon-back mui-action-back" style="color:white;"></a>
				<h1 class="mui-title" style="color:white;">顾客画像</h1>
				<span style="float:right;line-height:44px;color:white;" id="show_moban">模板</span>
				<!-- 浮动显示 -->
				<div class="group_tj animated flipInY">
					<!-- <fieldset class="group_sx">
                        <legend style="font-size: 20px;font-family: fantasy;text-align: center;">筛选条件</legend>
                        <textarea id='' type="" class='inpu_textarea' name=" ">烘干机打开</textarea>
                    </fieldset> -->
					<div class="mui-row" style="text-align: center;padding-bottom: 7px;">
						<div class="mui-col-xs-4 mui-col-sm-4">
							<button type="button" class="mui-btn" style="font-size: 12px;"
								onclick="cancel()">重置筛选</button>
						</div>
						<div class="mui-col-xs-4 mui-col-sm-4">
							<button type="button" class="mui-btn mui-btn-warning" style="font-size: 12px;"
								onclick="preservation()">保存模板</button>
						</div>
						<div class="mui-col-xs-4 mui-col-sm-4">
							<button type="button" class="mui-btn mui-btn-primary" style="font-size: 12px;"
								onclick="confirm()">确定筛选</button>
						</div>
					</div>
				</div>
			</header>
			<!-- 主页面内容容器 -->
			<div class="mui-scroll-wrapper">
				<div class="mui-scroll" style="padding-top: 120px;">
					<!-- 主界面具体展示内容 -->
					<!-- 基本信息 -->
					<fieldset class="group_show" style="margin-top: 0px;display: none;">
						<legend>基本信息</legend>
						<div class="checkboxStyle">
							<!-- 是否微信绑定 -->
							<div class="mui-row">
								<p value="vvip">是否微信绑定: &nbsp;<span style="color:#00a4ff"></span></p>
								<!-- <span>
									<input type="radio" id="love1" name="radio1" value="全部" value_num="false" checked
										onclick="radio_label(this)" />
									<label for="love1">全部</label>
								</span> -->
								<span>
									<input type="radio" id="love2" name="radio1" value="已绑定" value_num="1"
										onclick="radio_label(this)" />
									<label for="love2">已绑定</label>
								</span><span>
									<input type="radio" id="love3" name="radio1" value="未绑定" value_num="0"
										onclick="radio_label(this)" />
									<label for="love3">未绑定</label>
								</span>
							</div>
							<br>
							<!-- 筛选范围 -->
							<!-- <div class="mui-row">
								<p value="all">筛选范围: &nbsp;<span style="color:#00a4ff">全部会员</span></p>
								<span>
									<input type="radio" id="love4" name="radio4" value="全部" value_num="false" checked
										onclick="radio_label(this)" />
									<label for="love4">全部会员</label>
								</span>
								<span>
									<input type="radio" id="love5" name="radio4" value="已绑定" value_num="me"
										onclick="radio_label(this)" />
									<label for="love5">我的会员</label>
								</span>
							</div> -->
						</div>
					</fieldset>
					<!-- 消费相关 -->
					<fieldset class="group_show" style="margin-top: 0px;">
						<legend>消费相关</legend>
						<div class="checkboxStyle">
							<!-- 消费金额 -->
							<div class="mui-row">
								<p attb_id="love6" value="total_consumption">消费金额: &nbsp;<span
										style="color:#00a4ff"></span>
								</p>

								<!-- <span>
									<input type="radio" id="love6" name="radio6" value="全部" value_num="false" checked
										onclick="radio_label(this)" />
									<label for="love6">全部</label>
								</span> -->
								<span>
									<input type="radio" id="love7" name="radio6" value="100~500元" value_num="100-500"
										onclick="radio_label(this)" />
									<label for="love7">100~500元</label>
								</span>
								<span>
									<input type="radio" id="love8" name="radio6" value="500~1000元" value_num="500-1000"
										onclick="radio_label(this)" />
									<label for="love8">500~1000元</label>
								</span>
								<span>
									<input type="radio" id="love" name="radio6" value="自定义" control="元"
										onclick="radio_label(this)" />
									<label for="love">自定义</label>
								</span>
							</div>
							<br>
							<!-- 消费次数 -->
							<div class="mui-row">
								<p value="consumption_times" attb_id="love9">消费次数: &nbsp;<span
										style="color:#00a4ff"></span></p>
								<!-- <span>
									<input type="radio" id="love9" name="radio9" value="全部" value_num="false" checked
										onclick="radio_label(this)" />
									<label for="love9">全部</label>
								</span> -->
								<span>
									<input type="radio" id="love10" name="radio9" value_num="0-10" value="0~10次"
										onclick="radio_label(this)" />
									<label for="love10">0~10次</label>
								</span>
								<span>
									<input type="radio" id="love11" name="radio9" value="10~20次" value_num="10-20"
										onclick="radio_label(this)" />
									<label for="love11">10~20次</label>
								</span>
								<span>
									<input type="radio" id="love12" name="radio9" value="自定义" control="次"
										onclick="radio_label(this)" />
									<label for="love12">自定义</label>
								</span>

							</div>
							<br>

							<!-- 最近消费时间 -->
							<!-- <div class="mui-row">
								<p attb_id="love109">最近消费时间: &nbsp;<span style="color:#00a4ff">全部</span></p>
								<span>
									<input type="radio" id="love109" name="radio109" value="全部" checked
										onclick="radio_label(this)" />
									<label for="love109">全部</label>
								</span>
								<span>
									<input type="radio" id="love110" name="radio109" value="今天"
										onclick="radio_label(this)" />
									<label for="love110">今天</label>
								</span>
								<span>
									<input type="radio" id="love111" name="radio109" value="昨天"
										onclick="radio_label(this)" />
									<label for="love111">昨天</label>
								</span>
								<span>
									<input type="radio" id="love112" name="radio109" value="最近七天"
										onclick="radio_label(this)" />
									<label for="love112">最近七天</label>
								</span>
								<span>
									<input type="radio" id="love113" name="radio109" value="最近30天"
										onclick="radio_label(this)" />
									<label for="love113">最近30天</label>
								</span>
								<span>
									<input type="radio" id="love114" name="radio109" value="自定义" control="天"
										onclick="dates(this)" />
									<label for="love114">自定义</label>
								</span>

							</div><br> -->



							<!-- 剩余积分 -->
							<div class="mui-row">
								<p attb_id="love13" value="residual_integral">剩余积分: &nbsp;<span
										style="color:#00a4ff"></span></p>
								<!-- <span>
									<input type="radio" id="love13" name="radio13" value="全部" value_num="false" checked
										onclick="radio_label(this)" />
									<label for="love13">全部</label>
								</span> -->
								<span>
									<input type="radio" id="love14" name="radio13" value="100~500分" value_num="100-500"
										onclick="radio_label(this)" />
									<label for="love14">100~500积分</label>
								</span>
								<span>
									<input type="radio" id="love15" name="radio13" value="500~1000分"
										value_num="500-1000" onclick="radio_label(this)" />
									<label for="love15">500~1000积分</label>
								</span>
								<span>
									<input type="radio" id="love16" name="radio13" value="自定义" control="积分"
										onclick="radio_label(this)" />
									<label for="love16">自定义</label>
								</span>
							</div>
							<br>
							<!-- 是否拥有未使用卡劵 -->
							<!-- <div class="mui-row">
								<p>是否拥有未使用卡劵: &nbsp;<span style="color:#00a4ff">全部</span></p>
								<span>
									<input type="radio" id="love17" name="radio17" value="全部" checked
										onclick="radio_label(this)" />
									<label for="love17">全部</label>
								</span>
								<span>
									<input type="radio" id="love18" name="radio17" value="有未使用"
										onclick="radio_label(this)" />
									<label for="love18">有未使用</label>
								</span>
								<span>
									<input type="radio" id="love19" name="radio17" value="无未使用"
										onclick="radio_label(this)" />
									<label for="love19">无未使用</label>
								</span>
							</div><br> -->
							<!-- 剩余余额 -->
							<!-- <div class="mui-row">
								<p attb_id="love20">剩余余额: &nbsp;<span style="color:#00a4ff">全部</span></p>
								<span>
									<input type="radio" id="love20" name="radio20" value="全部" checked
										onclick="radio_label(this)" />
									<label for="love20">全部</label>
								</span>
								<span>
									<input type="radio" id="love21" name="radio20" value="100~500元"
										onclick="radio_label(this)" />
									<label for="love21">100~500元</label>
								</span>
								<span>
									<input type="radio" id="love22" name="radio20" value="500~1000元"
										onclick="radio_label(this)" />
									<label for="love22">500~1000元</label>
								</span>
								<span>
									<input type="radio" id="love23" name="radio20" value="自定义" control="元"
										onclick="radio_label(this)" />
									<label for="love23">自定义</label>
								</span>
							</div> -->
						</div>
					</fieldset>
					<!-- 会员信息 -->
					<fieldset class="group_show">
						<legend style="font-size: 20px;font-family: fantasy;text-align: center;">会员信息</legend>
						<div class="checkboxStyle">
							<!-- 性别 -->
							<div class="mui-row">
								<p value="sex">性别: &nbsp;<span style="color:#00a4ff"></span></p>
								<!-- <span>
									<input type="radio" id="love24" name="radio24" value="全部" value_num="false" checked
										onclick="radio_label(this)" />
									<label for="love24">全部</label>
								</span> -->
								<span>
									<input type="radio" id="love25" name="radio24" value="男" value_num="M"
										onclick="radio_label(this)" />
									<label for="love25">男</label>
								</span><span>
									<input type="radio" id="love26" name="radio24" value="女" value_num="W"
										onclick="radio_label(this)" />
									<label for="love26">女</label>
								</span>
							</div>
							<br>
							<!-- 生日 -->
							<!-- <div class="mui-row">
								<p>生日: &nbsp;<span style="color:#00a4ff">全部</span></p>
								<span>
									<input type="radio" id="love27" name="radio27" value="全部" value_num="false" checked
										onclick="radio_label(this)" />
									<label for="love27">全部</label>
								</span>
								<span>
									<input type="radio" id="love28" name="radio27" value="1~3天"
										onclick="radio_label(this)" />
									<label for="love28">1~3天</label>
								</span>
								<span>
									<input type="radio" id="love29" name="radio27" value="1~7天"
										onclick="radio_label(this)" />
									<label for="love29">1~7天</label>
								</span>
								<span>
									<input type="radio" id="love30" name="radio27" value="自定义" onclick="dates(this)" />
									<label for="love30">自定义</label>
								</span>
							</div>
							<br> -->
							<!-- 是否关注公众号 -->
							<!-- <div class="mui-row">
								<p>是否关注公众号: &nbsp;<span style="color:#00a4ff">全部</span></p>
								<span>
									<input type="radio" id="love31" name="radio31" value_num="false" value="全部" checked
										onclick="radio_label(this)" />
									<label for="love31">全部</label>
								</span>
								<span>
									<input type="radio" id="love32" name="radio31" value="是"
										onclick="radio_label(this)" />
									<label for="love32">是</label>
								</span><span>
									<input type="radio" id="love33" name="radio31" value="否"
										onclick="radio_label(this)" />
									<label for="love33">否</label>
								</span>
							</div>
							<br> -->
							<!-- 是否绑定客服 -->
							<!-- <div class="mui-row">
								<p>是否绑定客服: &nbsp;<span style="color:#00a4ff">全部</span></p>
								<span>
									<input type="radio" id="love34" name="radio34" value="全部" value_num="false" checked
										onclick="radio_label(this)" />
									<label for="love34">全部</label>
								</span>
								<span>
									<input type="radio" id="love35" name="radio34" value="是"
										onclick="radio_label(this)" />
									<label for="love35">是</label>
								</span><span>
									<input type="radio" id="love36" name="radio34" value="否"
										onclick="radio_label(this)" />
									<label for="love36">否</label>
								</span>
							</div> -->
						</div>

						<!-- 复选标签 -->
						<div class="RadioStyle" id="checkbox_biaoqian">
							<div class="mui-row" id="checkbox_hy">
								<p value="level_code">会员卡: &nbsp;<span style="color:#00a4ff"></span></p>
								<span>
									<input type="checkbox" id="box" value="全部" value_num="false"
										onclick="checkbox_lable(this)" />
									<label for="box" style="display: none;">全部</label>
								</span>

							</div>

							<div class="mui-row" id="checkbox_md">
								<p value="level_code">门店: &nbsp;<span style="color:#00a4ff"></span></p>
								<span>
									<input type="checkbox" id="bom" value="全部" value_num="false"
										onclick="checkbox_lable(this)" />
									<label for="box" style="display: none;">全部</label>
								</span>

							</div>
							<!-- <div class="mui-row">
                                <p>是否绑定客服: &nbsp;<span style="color:#00a4ff">全部</span></p>
                                <span>
                                    <input type="checkbox" id="done1" value="全部" checked onclick="checkbox_lable(this)" />
                                    <label for="done1">全部</label>
                                </span>
                                <span>
                                    <input type="checkbox" id="done2" value="是" onclick="checkbox_lable(this)" />
                                    <label for="done2">是</label>
                                </span><span>
                                    <input type="checkbox" id="done3" value="否" onclick="checkbox_lable(this)" />
                                    <label for="done3">否</label>
                                </span>
                            </div> -->
						</div>
					</fieldset>
				</div>
			</div>

		</div>
	</div>

</body>
<script>
	hidden_title();
	//加载动画
	var load = new Loading();
	load.init();
	load.start();

	var arrar = [];
	// 帮助后端清除缓存
	function clern_server() {
		mui.post('/index.php/webCustomerCacheNull/', {
		}, function (data) {
			//服务器返回响应，根据响应结果，分析是否登录成功；
			if (data.code == 200) {
			}
		}, 'json'
		);
	}
	// 进来刷新选择
	function hhh() {
		// 微信绑定
		document.getElementById("love2").checked = false;
		document.getElementById("love3").checked = false;
		// 消费相关
		document.getElementById("love").checked = false;
		document.getElementById("love7").checked = false;
		document.getElementById("love8").checked = false;
		// 消费次数
		document.getElementById("love10").checked = false;
		document.getElementById("love11").checked = false;
		document.getElementById("love12").checked = false;
		// 剩余积分
		document.getElementById("love14").checked = false;
		document.getElementById("love15").checked = false;
		document.getElementById("love16").checked = false;
		// 性别
		document.getElementById("love25").checked = false;
		document.getElementById("love26").checked = false;
	}


	hhh();
	clern_server();
	mui('.mui-scroll-wrapper').scroll({
		deceleration: 0.0005 //flick 减速系数，系数越大，滚动速度越慢，滚动距离越小，默认值0.0006
	});
	// 控制样式,还原属性
	var yuan = "";
	// hidden_title();
	// 取消筛选
	function cancel() {
		history.go(0);
	}

	// 保存模板
	function preservation() {
		var content_txt = "";
		for (o = 0; o < hjt.length; o++) {
			if (hjt[o]['value'].length == 1) {
				if (hjt[o]['name'] == 'vvip') {
					content_txt += '是否绑定微信' + ':' + hjt[o]['value'] + "<br>"
				} else if (hjt[o]['name'] == 'total_consumption') {
					content_txt += '消费金额' + ':' + hjt[o]['value'] + "<br>"
				} else if (hjt[o]['name'] == 'consumption_times') {
					content_txt += '消费次数' + ':' + hjt[o]['value'] + "<br>"
				} else if (hjt[o]['name'] == 'residual_integral') {
					content_txt += '剩余积分' + ':' + hjt[o]['value'] + "<br>"
				} else if (hjt[o]['name'] == 'sex') {
					content_txt += '性别' + ':' + hjt[o]['value'] + "<br>"
				} else {
					content_txt += hjt[o]['name'] + ':' + hjt[o]['value'] + "<br>"
				}

			} else {
				if (hjt[o]['name'] == 'level_code') {
					content_txt += '会员卡' + ':' + hjt[o]['value'] + "<br>"
				} else {
					content_txt += hjt[o]['name'] + ':' + hjt[o]['value'].join() + "<br>"
				}

			}

		}

		content_txt = "<div style='text-align:left;font-size:15px;'>" + content_txt + "</div>"
		mui.confirm('', '选择需要保存的模板', ['专场营销', '画像模板'], function (e) {
			// e.index == 1
			if (e.index == 1) {
				// 画像模板
				mui.prompt('', '请输入保存模板名称', '保存模板', ['取消', '确定'], function (e) {
					if (e.index == 1) {
						if (e.value != "") {
							mui.post('/index.php/webCustomerPreservation/', {
								text: '【' + e.value + '】' + '<br>' + content_txt
							}, function (data) {
								//服务器返回响应，根据响应结果，分析是否登录成功；
								if (data.code == 200) {
									mui.toast('模板 [ ' + e.value + ' ] 已保存', {
										duration: 'long',
										type: 'div'
									})
									window_moban();
									// 保存成功清除缓存
									clern_server();
								} else if (data.code == 400) {
									mui.toast(data.msg, {
										duration: 'long',
										type: 'div'
									})
								}
							}, 'json'
							);


						} else {
							mui.toast('模板不能为空', {
								duration: 'long',
								type: 'div'
							})
							return false;
						}

					} else {
					}
				})

			} else {
				// 跟进模板
				mui.prompt('', '请输入保存模板名称', '保存模板', ['取消', '确定'], function (e) {
					if (e.index == 1) {
						if (e.value != "") {
							mui.post('/index.php/webVipSpecial/', {
								text: '【' + e.value + '】' + '<br>' + content_txt
							}, function (data) {
								//服务器返回响应，根据响应结果，分析是否登录成功；
								if (data.code == 200) {
									mui.toast('模板 [ ' + e.value + ' ] 已保存', {
										duration: 'long',
										type: 'div'
									})
									window_moban();
									// 保存成功清除缓存
									clern_server();
								} else if (data.code == 400) {
									mui.toast(data.msg, {
										duration: 'long',
										type: 'div'
									})
								}
							}, 'json'
							);


						} else {
							mui.toast('模板不能为空', {
								duration: 'long',
								type: 'div'
							})
							return false;
						}

					} else {
					}
				})
			}
		})






	}

	// 确认筛选
	function confirm() {

		if (arrar == "") {
			mui.toast('请勾选筛选所需要的条件', {
				duration: 'long',
				type: 'div'
			});
		} else {
			localStorage.setItem("huancun", 'false');
			location.href = "../homepage/wx_condition_group_son.html?condition=false";
		}

	}

	// 标签
	function radio_label(h) {

		var kk = h.getAttribute("id");
		var value = h.getAttribute("value");
		var pp = document.getElementById(kk).parentNode.parentNode.firstElementChild.firstElementChild;
		var key = document.getElementById(kk).parentNode.parentNode.firstElementChild.getAttribute("value");
		var att_id = document.getElementById(kk).parentNode.parentNode.firstElementChild.getAttribute("attb_id");
		arrar.push(kk);

		if (h.getAttribute("value") != "自定义") {
			pp.innerHTML = h.getAttribute("value");


			yuan = h.getAttribute("id");

			radio_ajax(key, h.getAttribute("value_num"));
			radio_Pd(key, value);
		} else {

			mui.prompt('', '请输入数据(用 . 小数点隔开)', '自定义', ['取消', '确定'], function (e) {
				// 点击了确定按钮
				if (e.index == 1) {
					if (e.value != "") {
						// 输入只出现数字和逗号 
						if (paths(e.value)) {
							// 只出现一个逗号
							if (counts(e.value) == 1) {
								if (chayi(e.value)) {
									pp.innerHTML = h.getAttribute("value") + ':' + getCaption(e.value) + h.getAttribute('control');
									radio_ajax(key, getCaption(e.value));
									radio_Pd(key, getCaption(e.value) + '元');

									mui.toast('数据 [ ' + getCaption(e.value) + ' ] 已添加', {
										duration: 'long',
										type: 'div'
									})
								} else {
									return false;
								}



							} else {
								mui.toast('只能出现一次小数点( . )', {
									duration: 'long',
									type: 'div'
								});
								return false;
							}
						} else {
							mui.toast('只能输入数字和小数点( . )', {
								duration: 'long',
								type: 'div'
							});
							return false;
						}
					} else {
						mui.toast('数据不能为空', {
							duration: 'long',
							type: 'div'
						})
						return false;
					}
				} else {

					if (yuan == "") {
						// document.getElementById(att_id).checked = "checked";
					} else {
						document.getElementById(yuan).checked = "checked";
					}

				}
			})
		}

	}


	function radio_ajax(key, val) {
		mui.post('/index.php/webCustomerServiceclickLabel/', {
			key: key,
			val: val
		}, function (data) {
			//服务器返回响应，根据响应结果，分析是否登录成功；

			if (data.code == 200) {
			}
			// }
		}, 'json'
		);
	}

	// 统计出现的逗号的个数
	function counts(re) {
		var n = (re.split('.')).length - 1;
		return n;
	}
	// 控制输出只能是数字
	function paths(re) {
		var rel = /^[0-9.]+$/;
		return rel.test(re);
	}

	function getCaption(obj) {
		var index = obj.lastIndexOf("\.");
		return obj.substring(0, index) + '-' + obj.substring(index + 1, obj.length);
	}

	function chayi(obj) {
		let index = obj.lastIndexOf("\.");
		let num = parseInt(obj.substring(0, index));
		let num2 = parseInt(obj.substring(index + 1, obj.length));
		if (num > num2) {
			mui.toast('区间格式不正确,' + num + '不能大于' + num2, {
				duration: 'long',
				type: 'div'
			})
			return false;
		} else if (num == num2) {
			mui.toast('区间格式不正确,' + num + '不能等于' + num2, {
				duration: 'long',
				type: 'div'
			})
			return false;
		} else {
			if (isNaN(num) && isNaN(num2)) {
				mui.toast('请填入正确格式', {
					duration: 'long',
					type: 'div'
				})
				return false;
			} else if (isNaN(num)) {
				mui.toast('小数点( . )前未填入数字', {
					duration: 'long',
					type: 'div'
				})
				return false;
			} else if (isNaN(num2)) {
				mui.toast('小数点( . )后未填入数字', {
					duration: 'long',
					type: 'div'
				})
				return false;
			} else {
				return true;
			}

		}
	}


	// 自定义时间
	function dates(h) {
		mui.confirm('请选择开始和结束时间', '自定义日期', ['开始', '结束'], function (e) {
			// e.index == 1
			if (e.index == 1) {
				// 结束日期
				end(h);
			} else {
				// 开始日期
				start(h);
				return false;
			}
		})
	}
	// 开始时间
	function start(h) {
		var kk = h.getAttribute("id");
		var pp = document.getElementById(kk).parentNode.parentNode.firstElementChild.firstElementChild;
		var dtpicker = new mui.DtPicker({
			type: "date", //设置日历初始视图模式
			beginDate: new Date(1970, 01, 01), //设置开始日期
			endDate: new Date(2070, 01, 01), //设置结束日期
			labels: ['年', '月', '日'], //设置默认标签区域提示语
		});
		//将时间显示
		dtpicker.show(function (items) {
			// sj[0].innerHTML = items.y.value;
			// sj[1].innerHTML = items.m.value;
			// sj[2].innerHTML = items.d.value;
			pp.innerHTML = h.getAttribute("value") + ': ' + items.y.value + "-" + items.m.value + "-" + items.d.value;

		})

	}
	// 结束时间
	function end(h) {
		var kk = h.getAttribute("id");
		var pp = document.getElementById(kk).parentNode.parentNode.firstElementChild.firstElementChild;
		var dtpicker = new mui.DtPicker({
			type: "date", //设置日历初始视图模式
			beginDate: new Date(1970, 01, 01), //设置开始日期
			endDate: new Date(2070, 01, 01), //设置结束日期
			labels: ['年', '月', '日'], //设置默认标签区域提示语
		});
		//将时间显示
		dtpicker.show(function (items) {
			// sj[0].innerHTML = items.y.value;
			// sj[1].innerHTML = items.m.value;
			// sj[2].innerHTML = items.d.value;
			pp.innerHTML = pp.innerHTML + ' ~ ' + items.y.value + "-" + items.m.value + "-" + items.d.value;
		})

	}

	var checkbox_bq = document.getElementById("checkbox_biaoqian");
	// 自动加载复选
	function onload() {
		mui.post('/index.php/Userlistlabel/', {}, function (data) {
			//服务器返回响应，根据响应结果，分析是否登录成功；
			if (data.code == 200) {
				if (data.data.length==0) {
					load.stop();
				} else {
					for (i = 0; i < data.data.length; i++) {
						var div = document.createElement("div");
						div.className = 'mui-row';
						div.id = "bq" + i;
						div.innerHTML = '<p value="' + data.data[i].name + '" style="padding-top:10px;">' + data.data[i].name +
							': &nbsp;<span style="color:#00a4ff"></span></p>' +
							'<span>' +
							'<input type="checkbox" id="done' + i + '" value="全部" value_num="false"  onclick="checkbox_lable(this)" />' +
							'<label for="done' + i + '" style="display:none;">全部</label>'
						' </span>'
						checkbox_bq.appendChild(div);
						opopopo('bq' + i, data.data[i].name, "done" + i, (data.data.length - 1), data.data[i].code);
					}
				}
			}else{
				load.stop();
			}
		}, 'json');
	}
	onload();

	function opopopo(id, name, idd, nambers, code) {
		mui.post('/index.php/UserlistlabelInfoq/', {
			name: name
		}, function (data) {
			//服务器返回响应，根据响应结果，分析是否登录成功；
			if (data.code == 200) {
				for (i = 0; i < data.data.length; i++) {
					var div = document.createElement("span");
					div.innerHTML = '<input type="checkbox" id="' + id + i + 'j' + '" value="' + data.data[i].info + '"  name="' +
						idd + '" value_num="' + data.data[i].info + '" code2="' + code + '"  id2="' + data.data[i].id + '" onclick="checkbox_lable(this)" />' +
						'<label for="' + id + i + 'j' + '">' + data.data[i].info + '</label>'
					' </span>'
					document.getElementById(id).appendChild(div);

					// lable_XH('BQ' + data.data[i].code, data.data[i].name);
				}
			}
			if (id == ('bq' + nambers)) {
				load.stop();
			}
		}, 'json');
	}
	// 会员卡
	var checkbox_hy = document.getElementById("checkbox_hy");
	function window_box_hy() {
		mui.post('/index.php/webCustomerLevel/', {}, function (data) {
			//服务器返回响应，根据响应结果，分析是否登录成功；
			if (data.code == 200) {

				for (i = 0; i < data.data.length; i++) {
					var span = document.createElement("span");
					span.innerHTML = '<input type="checkbox"  id="box' + i + '" name="box" value="' + data.data[i].username + '" code2="level_code" onclick="checkbox_lable(this)" id2="' + data.data[i].code + '"/>'
						+ '<label for="box' + i + '">' + data.data[i].username + '</label>'
					checkbox_hy.appendChild(span)
					// opopopo('bq' + i, data.data[i].name, "done" + i);
				}


			}
		}, 'json');
	}
	window_box_hy();
	// 门店
	var checkbox_md = document.getElementById("checkbox_md");
	function window_box_md() {
		mui.post('/index.php/Userlistwsstoree/', {}, function (data) {
			//服务器返回响应，根据响应结果，分析是否登录成功；
			if (data.code == 200) {

				for (i = 0; i < data.data.length; i++) {
					var span = document.createElement("span");
					span.innerHTML = '<input type="checkbox"  id="bom' + i + '" name="bom" value="' + data.data[i].name + '" code2="store_code" onclick="checkbox_lable(this)" id2="' + data.data[i].code + '"/>'
						+ '<label for="bom' + i + '">' + data.data[i].name + '</label>'
					checkbox_md.appendChild(span)
					// opopopo('bq' + i, data.data[i].name, "done" + i);
				}
			}
		}, 'json');
	}
	window_box_md();

	var hjt = [];
	// 复选框
	function checkbox_lable(g) {
		var val = g.getAttribute("value_num");
		var kk = g.getAttribute("id");
		var pp = document.getElementById(kk).parentNode.parentNode.firstElementChild.firstElementChild;
		var key = document.getElementById(kk).parentNode.parentNode.firstElementChild.getAttribute("value");
		var value_name = document.getElementById(kk).parentNode.parentNode.firstElementChild.getAttribute("value");
		// 点击全部触发全选事件
		if (g.getAttribute('value') == "全部") {
			pp.innerHTML = g.getAttribute('value');
			var son = document.getElementsByName(g.getAttribute('id'));

			if (g.checked == true) {
				// checkbox_ajax(key, val);
				//Action for checked
				for (var i = 0; i < son.length; i++) {
					son[i].checked = true;
				}
			} else {
				pp.innerHTML = "";
				for (var i = 0; i < son.length; i++) {
					son[i].checked = false;
				}
				//Action for not checked
			}
		} else {
			// 点击其余的复选,将关闭全选
			if (document.getElementById(g.getAttribute('name')).checked == true) {
				var sons = document.getElementsByName(g.getAttribute('name'));
				for (var d = 0; d < sons.length; d++) {
					sons[d].checked = false;
				}
				document.getElementById(g.getAttribute('name')).checked = false;
				pp.innerHTML = "";
			} else {
				if (g.checked == true) {
					var span = document.createElement("span");
					span.id = 'i' + kk;
					span.innerHTML = g.getAttribute("value") + ',';
					pp.appendChild(span);
					Pdvalue(true, g.getAttribute("value"), value_name)
					Pd(true, kk)
				} else {
					pp.removeChild(document.getElementById('i' + kk))
					Pdvalue(false, g.getAttribute("value"), value_name)
					Pd(false, kk)
				}


				checkbox_ajax(g.getAttribute("code2"), g.getAttribute("id2"));
			}
		}
	}
	// 选择标签
	function checkbox_ajax(key, val) {
		mui.post('/index.php/webCustomerServiceclickLabel/', {
			key: key,
			val: val
		}, function (data) {
			//服务器返回响应，根据响应结果，分析是否登录成功；

			if (data.code == 200) {
			}
			// }
		}, 'json'
		);
	}
</script>


<script type="text/javascript">
	var animat = document.getElementsByClassName("animated");
	// 打开弹框
	document.getElementById("show_moban").addEventListener("tap", function () {
		mui('.mui-off-canvas-wrap').offCanvas().show();

		for (i = 0; i < animat.length; i++) {
			if (i % 2 == 0) {
				animat[i].classList.add("bounceInLeft");
			} else {
				animat[i].classList.add("bounceInRight");
			}
		}

	});

	// 关闭弹框
	document.getElementById("close_moban").addEventListener("tap", function () {
		mui('.mui-off-canvas-wrap').offCanvas().close();
		for (i = 0; i < animat.length; i++) {
			if (i % 2 == 0) {
				animat[i].classList.remove("bounceInLeft");
			} else {
				animat[i].classList.remove("bounceInRight");
			}
		}
	});

	// 
	mui(".biz_timtline-box").on('tap', '.biz_timeline-event', function () {
		//获取id
		var id = this.getAttribute("idd");
		var name_content = this.getAttribute("name_content");
		mui.confirm('', '请选择操作', ['删除', '详情', '筛选'], function (e) {
			// e.index == 1
			if (e.index == 2) {
				location.href = "../homepage/wx_condition_group_son.html?condition=" + id;
				localStorage.setItem("huancun", id);
			} else if (e.index == 1) {
				mui.alert('', name_content, ['了解'], function (e) { })

			} else {
				mui.post('/index.php/webCustomerScreenDel/', {
					id: id
				}, function (data) {
					//服务器返回响应，根据响应结果，分析是否登录成功；
					if (data.code == 200) {
						history.go(0);
					}
				}, 'json'
				);
			}
		})
	})
	var biz_timeline_moban = document.getElementById("biz_timeline_moban");

	function window_moban() {
		mui.post('/index.php/webCustomerScreenList/', {
		}, function (data) {
			//服务器返回响应，根据响应结果，分析是否登录成功；
			if (data.code == 200) {
				biz_timeline_moban.innerHTML = "";
				for (i = 0; i < data.data.length; i++) {
					var div = document.createElement("div");
					div.className = "biz-timeline-box  clearfix animated";
					div.innerHTML = '<div class="biz_timeline-eventbox">'
						+ '<div class="biz_timeline-event jsdkaf" idd="' + data.data[i].id + '" name_content="' + data.data[i].title + '">' + data.data[i].title + '</div>'
						+ '</div>'
					biz_timeline_moban.appendChild(div);
				}
				$(".biz_longString").css('height', document.getElementById("biz_timeline_moban").clientHeight + 157);
			}
		}, 'json'
		);
	}
	window_moban()



	function Pd(TF, kk) {
		if (TF) {
			// 选中
			arrar.push(kk);
			// console.log(arrar);
		} else {
			// 取消
			for (i = 0; i < arrar.length; i++) {
				if (arrar[i] == kk) {
					arrar.splice(i, 1);
				}
			}
			// console.log(arrar);
		}
	}

	var si_ll = [];
	var myObj = {};
	var content = false;
	function Pdvalue(TF, kk, value_name) {
		if (TF) {
			// 选中
			if (hjt.length == 0) {
				si_ll = [kk];
				myObj = {
					"name": value_name,
					"value": si_ll
				}
				hjt.push(myObj);

			} else {
				for (l = 0; l < hjt.length; l++) {
					if (hjt[l]['name'] == value_name) {
						hjt[l]['value'].push(kk);
						content = true;
						break;
					} else {
						content = false;

					}
				}
				if (!content) {
					si_ll = [kk];
					myObj = {
						"name": value_name,
						"value": si_ll
					}
					hjt.push(myObj);
				}

			}
		} else {
			// 取消
			for (l = 0; l < hjt.length; l++) {
				if (hjt[l]['name'] == value_name) {
					for (i = 0; i < hjt[l]['value'].length; i++) {
						if (hjt[l]['value'][i] == kk) {
							hjt[l]['value'].splice(i, 1);
						}
					}

				}
			}
		}
	}

	function radio_Pd(value_name, kk) {
		if (hjt.length == 0) {
			si_ll = [kk];
			myObj = {
				"name": value_name,
				"value": si_ll
			}
			hjt.push(myObj);

		} else {
			for (l = 0; l < hjt.length; l++) {
				if (hjt[l]['name'] == value_name) {
					hjt[l]['value'] = kk;
					content = true;
					break;
				} else {
					content = false;

				}
			}
			if (!content) {
				si_ll = [kk];
				myObj = {
					"name": value_name,
					"value": si_ll
				}
				hjt.push(myObj);
			}

		}

	}



</script>

</html>