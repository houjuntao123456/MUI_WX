<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link rel="stylesheet" href="../../mui/css/mui.css">
    <link rel="stylesheet" href="../../css/wx_chat2.css">
    <link rel="stylesheet" href="../../css/chat_iconfont.css">
    <script src="../../mui/js/mui.js"></script>
    <script src="../../js/vconsole.js"></script>
    <script src="../../js/jquery.min.js"></script>
    <!-- <script src="../js/jquery.qq_min.js"></script> -->
    <!-- <script src="../js/jquery.qqFace2.js"></script> -->
    <script src="../../js/jquery.cookie.js"></script>

    <title>聊天</title>
    <style>
        .question,
        .answer {
            margin-bottom: 1rem;
        }

        .question {
            text-align: right;
        }

        .question>div {
            display: inline-block;
        }

        .answer>div {
            display: inline-block;
        }

        .left {
            float: left;
            position: relative;
        }

        .right {
            float: right;
            position: relative;
        }

        .clear {
            clear: both;
        }

        .heard_img {
            height: 50px;
            width: 50px;
            border-radius: 5px;
            overflow: hidden;
            background: #ddd;
            margin-right: 5px;
        }

        .heard_img img {
            width: 100%;
            height: 100%
        }

        .heard_huida {
            height: 50px;
            width: 50px;
            border-radius: 5px;
            overflow: hidden;
            background: #ddd;
            margin-left: 5px;
        }

        .heard_huida img {
            width: 100%;
            height: 100%
        }

        .question_text,
        .answer_text {
            box-sizing: border-box;
            position: relative;
            display: table-cell;
            min-height: 60px;
        }

        .question_text {
            padding-right: 14px;
        }

        .answer_text {
            padding-left: 15px;
        }

        .question_text p,
        .answer_text p {
            border-radius: 10px;
            padding: .5rem;
            margin: 0;
            font-size: 14px;
            line-height: 28px;
            box-sizing: border-box;
            vertical-align: middle;
            display: table-cell;
            height: 60px;
            word-wrap: break-word;
        }

        .answer_text p {
            background: #fff;
            color: black;
        }

        .question_text p {
            background: #9EEA6A;
            color: black;
            text-align: left;
        }

        .question_text i,
        .answer_text i {
            width: 0;
            height: 0;
            border-top: 5px solid transparent;
            border-bottom: 5px solid transparent;
            position: absolute;
            top: 19px;
        }

        .answer_text i {
            border-right: 10px solid #fff;
            left: 5px;
        }

        .question_text i {
            border-left: 10px solid #9EEA6A;
            right: 5px;
        }

        /* 
    
    
    */
        #content_chat {
            position: fixed;
            left: 0px;
            right: 0px;
            bottom: 50px;
            /* overflow: hidden; */
        }

        .question_Name {
            position: absolute;
            top: 50px;
            right: 8px;
            font-size: 12px;
        }

        .answer_Name {
            position: absolute;
            top: 50px;
            left: 10px;
            font-size: 12px;
        }

        .display {
            display: none;
        }

        /* .Answer_data_img:hover{
            width: 500px;
        } */

        .picture_div {
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            position: fixed;
            z-index: 1;
            top: 0px;
        }
    </style>
</head>

<body>
    <!-- <header class="mui-bar mui-bar-nav">
            <a class="mui-action-back mui-icon mui-icon-left-nav mui-pull-left"></a>
            <h1 class="mui-title">chat (聊天窗口)</h1>
        </header> -->
    <!-- 内容 -->
    <div class="picture_div display" id="picture_div">
        <div style="width: 90%;margin: 0 auto;margin-top:100px;overflow-y: scroll; height: 70%;">
            <img id="picture_div_img" src="" alt="" width="100%">
        </div>
    </div>

    <div class="mui-content" id="content_chat">
        <br>
        <!-- <button onclick="kop()">暂停</button> -->
        <!-- 反馈收到数据框 -->
        <!-- <div class="answer">
            <div class="left">
                <div class="heard_huida">
                    <img src="../images/account.png">
                </div>
                <div class="answer_Name">东皇太一</div>
            </div>
            <div class="answer_text clear" style="max-width: 70%;">
                <p>
                    <audio id="myAudio" controls style="width:200px;">
                       
                        <source src="../js/horse.mp3" type="audio/mp3">
                    </audio>
                </p>
                <i></i>
            </div>
        </div> -->

        <!-- 提出发送的数据 -->
        <!-- <div class="question">
            <div class="right">
                <div class="heard_img">
                    <img src="../images/up.png">
                </div>
                <div class="question_Name">东皇太一</div>
            </div>
            <div class="question_text clear" style="max-width: 70%;">
                <p><img src="../../arclist/46.gif" border="0" />
                    三方科技空间即可连接空间就看见看见看见看见了看见骷髅精灵看见了看见了看见了看见家家户户炬华科技第三方科技空间即可连接空间就看见看见看见看见了看见骷髅精灵看见了看见了看见了看见
                </p>
                <i></i>
            </div>
        </div> -->

    </div>
    <!-- 底部 -->
    <footer id="footer_bottom">
        <section id="section_bottom">
            <div class="footer-left">
                <i id='msg-mic' class="iconfont icon-yuyin"></i>
                <i id='msg-bars' class="iconfont icon-jianpan" style="display: none;"></i>
            </div>
            <div class="footer-center">
                <textarea id='msg-text' type="text" class='input-text' name="msg-text"></textarea>
                <button id='msg-sound' type="button" class='input-sound' style="display: none;">按住说话</button>
            </div>
            <div for="" class="footer-right">
                <i id='msg-pengyouquan' class="iconfont icon-xiaolian"></i>&nbsp;
                <i id='msg-image' class="iconfont icon-jiahao"></i>
                <button id='msg-send' type="button" class="mui-btn mui-btn-success"
                    style="padding: 4px 5px 4px 5px;position: relative;bottom: 5px; display: none;">发送</button>
            </div>
        </section>
        <!-- 表情容器 -->
        <section id="section_bq" class="display" style="background-color: #fafafa;">
            <table border="0" id="facebox" cellspacing="0" cellpadding="0" style="width:100%;">
                <tr>
                    <td style="width:10%;"><img src="../../arclist/1.gif" value="[/::)]" /></td>
                    <td style="width:10%;"><img src="../../arclist/2.gif" value="[/::~]" /></td>
                    <td style="width:10%;"><img src="../../arclist/3.gif" value="[/::B]" /></td>
                    <td style="width:10%;"><img src="../../arclist/4.gif" value="[/::|]" /></td>
                    <td style="width:10%;"><img src="../../arclist/5.gif" value="[/::<]" /></td>
                    <td style="width:10%;"><img src="../../arclist/6.gif" value="[/::$]" /></td>
                    <td style="width:10%;"><img src="../../arclist/7.gif" value="[/::X]" /></td>
                    <td style="width:10%;"><img src="../../arclist/8.gif" value="[/::Z]" /></td>
                    <td style="width:10%;"><img src="../../arclist/9.gif" value="[/::'(]" /></td>
                    <td style="width:10%;"><img src="../../arclist/10.gif" value="[/::-|]" /></td>
                </tr>
                <tr>
                    <td style="width:10%;"><img src="../../arclist/11.gif" value="[/::@]" /></td>
                    <td style="width:10%;"><img src="../../arclist/12.gif" value="[/::P]" /></td>
                    <td style="width:10%;"><img src="../../arclist/13.gif" value="[/::D]" /></td>
                    <td style="width:10%;"><img src="../../arclist/14.gif" value="[/::O]" /></td>
                    <td style="width:10%;"><img src="../../arclist/15.gif" value="[/::(]" /></td>
                    <td style="width:10%;"><img src="../../arclist/16.gif" value="[Blush]" /></td>
                    <td style="width:10%;"><img src="../../arclist/17.gif" value="[/::Q]" /></td>
                    <td style="width:10%;"><img src="../../arclist/18.gif" value="[/::T]" /></td>
                    <td style="width:10%;"><img src="../../arclist/19.gif" value="[/:,@P]" /></td>
                    <td style="width:10%;"><img src="../../arclist/20.gif" value="[/:,@-D]" /></td>
                </tr>

                <tr>
                    <td style="width:10%;"><img src="../../arclist/21.gif" value="[/::d]" /></td>
                    <td style="width:10%;"><img src="../../arclist/22.gif" value="[/:,@o]" /></td>
                    <td style="width:10%;"><img src="../../arclist/23.gif" value="[/::g]" /></td>
                    <td style="width:10%;"><img src="../../arclist/24.gif" value="[/:|-)]" /></td>
                    <td style="width:10%;"><img src="../../arclist/25.gif" value="[/::!]" /></td>
                    <td style="width:10%;"><img src="../../arclist/26.gif" value="[/::L]" /></td>
                    <td style="width:10%;"><img src="../../arclist/27.gif" value="[/::>]" /></td>
                    <td style="width:10%;"><img src="../../arclist/28.gif" value="[/::,@]" /></td>
                    <td style="width:10%;"><img src="../../arclist/29.gif" value="[/:,@f]" /></td>
                    <td style="width:10%;"><img src="../../arclist/30.gif" value="[/::-S]" /></td>
                </tr>
                <tr>
                    <td style="width:10%;"><img src="../../arclist/31.gif" value="[/:?]" /></td>
                    <td style="width:10%;"><img src="../../arclist/32.gif" value="[/:,@x]" /></td>
                    <td style="width:10%;"><img src="../../arclist/33.gif" value="[/:,@@]" /></td>
                    <td style="width:10%;"><img src="../../arclist/34.gif" value="[/::8]" /></td>
                    <td style="width:10%;"><img src="../../arclist/35.gif" value="[/:,@!]" /></td>
                    <td style="width:10%;"><img src="../../arclist/36.gif" value="[/:xx]" /></td>
                    <td style="width:10%;"><img src="../../arclist/37.gif" value="[/:bye]" /></td>
                    <td style="width:10%;"><img src="../../arclist/38.gif" value="[/:wipe]" /></td>
                    <td style="width:10%;"><img src="../../arclist/39.gif" value="[/:dig]" /></td>
                    <td style="width:10%;"><img src="../../arclist/40.gif" value="[/:&-(]" /></td>
                </tr>
                <tr>
                    <td style="width:10%;"><img src="../../arclist/41.gif" value="[/:B-)]" /></td>
                    <td style="width:10%;"><img src="../../arclist/42.gif" value="[/:<@]" /></td>
                    <td style="width:10%;"><img src="../../arclist/43.gif" value="[/:@>]" /></td>
                    <td style="width:10%;"><img src="../../arclist/44.gif" value="[/::-O]" /></td>
                    <td style="width:10%;"><img src="../../arclist/45.gif" value="[/:>-|]" /></td>
                    <td style="width:10%;"><img src="../../arclist/46.gif" value="[/:P-(]" /></td>
                    <td style="width:10%;"><img src="../../arclist/47.gif" value="[/::'|]" /></td>
                    <td style="width:10%;"><img src="../../arclist/48.gif" value="[/:X-)]" /></td>
                    <td style="width:10%;"><img src="../../arclist/49.gif" value="[/::*]" /></td>
                    <td style="width:10%;"><img src="../../arclist/50.gif" value="[/:@x]" /></td>
                </tr>
                <tr>
                    <td style="width:10%;"><img src="../../arclist/51.gif" value="[/:8*]" /></td>
                    <td style="width:10%;"><img src="../../arclist/52.gif" value="[/:hug]" /></td>
                    <td style="width:10%;"><img src="../../arclist/53.gif" value="[/:moon]" /></td>
                    <td style="width:10%;"><img src="../../arclist/54.gif" value="[/:sun]" /></td>
                    <td style="width:10%;"><img src="../../arclist/55.gif" value="[/:bome]" /></td>
                    <td style="width:10%;"><img src="../../arclist/56.gif" value="[/:!!!]" /></td>
                    <td style="width:10%;"><img src="../../arclist/57.gif" value="[/:pd]" /></td>
                    <td style="width:10%;"><img src="../../arclist/58.gif" value="[/:pig]" /></td>
                    <td style="width:10%;"><img src="../../arclist/59.gif" value="[/:<W>]" /></td>
                    <td style="width:10%;"><img src="../../arclist/60.gif" value="[/:coffee]" /></td>
                </tr>
                <tr>
                    <td style="width:10%;"><img src="../../arclist/61.gif" value="[/:eat]" /></td>
                    <td style="width:10%;"><img src="../../arclist/62.gif" value="[/:heart]" /></td>
                    <td style="width:10%;"><img src="../../arclist/63.gif" value="[/:strong]" /></td>
                    <td style="width:10%;"><img src="../../arclist/64.gif" value="[/:weak]" /></td>
                    <td style="width:10%;"><img src="../../arclist/65.gif" value="[/:share]" /></td>
                    <td style="width:10%;"><img src="../../arclist/66.gif" value="[/:v]" /></td>
                    <td style="width:10%;"><img src="../../arclist/67.gif" value="[/:@)]" /></td>
                    <td style="width:10%;"><img src="../../arclist/68.gif" value="[/:jj]" /></td>
                    <td style="width:10%;"><img src="../../arclist/69.gif" value="[/:ok]" /></td>
                    <td style="width:10%;"><img src="../../arclist/70.gif" value="[/:no]" /></td>
                </tr>
                <tr>
                    <td style="width:10%;"><img src="../../arclist/71.gif" value="[/:rose]" /></td>
                    <td style="width:10%;"><img src="../../arclist/72.gif" value="[/:fade]" /></td>
                    <td style="width:10%;"><img src="../../arclist/73.gif" value="[/:showlove]" /></td>
                    <td style="width:10%;"><img src="../../arclist/74.gif" value="[/:love]" /></td>
                    <td style="width:10%;"><img src="../../arclist/75.gif" value="[/:<L>]" /></td>
                </tr>
            </table>

        </section>

    </footer>
</body>
<script>
    // var hd = window.parent.document.getElementById("nav");
    // hd.style.display = "none";
    // var hh = window.parent.document.getElementsByClassName("mui-iframe-wrapper");
    // hh[0].style.bottom = "0px";
    var loc = location.href;
    var n1 = loc.length;
    var n2 = loc.indexOf('=');
    var code = decodeURI(loc.substr(n2 + 1, n1 - n2));
    // 点击笑脸按钮显示图标列表
    document.getElementById("msg-pengyouquan").onclick = function () {
        close_TB();
    }
    //点击图标触发的事件
    mui("#facebox").on('tap', 'img', function () {
        mui("#msg-send")[0].style.display = "";
        mui("#msg-image")[0].style.display = "none";
        // 获取id
        var value = this.getAttribute("value");
        var jj = code_name(value);
        // 文本框内容
        document.getElementById("msg-text").value = document.getElementById("msg-text").value + code_name(value);
        close_TB();

    })
    //开关表情
    function close_TB() {
        if (document.getElementById("section_bq").classList.contains("display")) {
            document.getElementById("section_bq").classList.remove('display');
        } else {
            document.getElementById("section_bq").classList.add('display');
            $('#content_chat')[0].style.bottom = "50px";
            $('#content_chat')[0].style.paddingTop = "50px";
        }
    }



    var time = "";
    // 获取收到的数据,将数据显示到界面(回答数据)
    var kkk = true;
    // 获取数据和将数据显示到对话框
    function qq() {
        mui.post('/index.php/UserlistWxChatRecord/', {
            code: code,
            createtime: time,
            company: $.cookie("company")
        }, function (data) {
            if (data.code == 200) {
                if (data.data == "null" || data.data == null) {
                } else {
                    if (data.data.length == 0) {
                        // console.log('触发');
                    } else {
                        time = data.data[data.data.length - 1].createTime;
                        for (var i = 0; i < data.data.length; i++) {
                            if (data.data[i].toUser == "null" || data.data[i].toUser == null) {
                                //管理员说的话
                                if (kkk) {
                                    Question_data(data.data[i].content);
                                }
                            } else {
                                //用户说的话
                                if (data.data[i].msgType == 'image') {
                                    Answer_data('<img class="Answer_data_img" src="' + data.data[i].img + '" alt="" width="150px">');
                                } else if (data.data[i].msgType == "voice") {
                                    Answer_data('<audio id="myAudio" controls style="width:200px;"><source src="' + data.data[i].voice + '" type="audio/mp3"></audio>')
                                } else {
                                    Answer_data(data.data[i].content);
                                }
                            }

                        }
                        kkk = false;

                    }
                }
            }
            //服务器返回响应，根据响应结果，分析是否登录成功；
        }, 'json'
        );
    }
    // qq();

    // 截取[]间的内容
    function code_name(str) {
        str = str.substring(str.indexOf("[") + 1, str.indexOf("]"))
        return str;
    }

    String.prototype.replaceAll = function (s1, s2) {
        return this.replace(new RegExp(s1, "gm"), s2);
    }

    function escapeRegExp(str) {
        return str.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g, "\\$&");
    }
    function replace_em(str) {
        for (var x = 0; x < TB.length; x++) {
            str = str.replaceAll(escapeRegExp(TB[x].icon), '<img src="' + TB[x].image + '" border="0"/>');
        }
        return str;
    }
</script>
<script>



    $(function () {
        $("#msg-text").bind('input porpertychange', function () {
            if (this.value.length < 13) {
                mui("#section_bottom")[0].style.minHeight = '50px';
                $('#content_chat')[0].style.bottom = "50px";
                $('#content_chat')[0].style.paddingTop = "50px";
            } else if (this.value.length >= 13) {
                // section_bottom
                mui("#section_bottom")[0].style.minHeight = '70px';
                $('#content_chat')[0].style.bottom = "70px";
                $('#content_chat')[0].style.paddingTop = "70px";
            } else if (this.value.length >= 26) {
                // section_bottom
                mui("#section_bottom")[0].style.minHeight = '100px';
                $('#content_chat')[0].style.bottom = "100px";
                $('#content_chat')[0].style.paddingTop = "100px";
            } else {

            }
        });

    });
</script>

<script>
    // var vConsole = new VConsole();
    // 点击话筒图标需进行操作
    // mui("#msg-mic")[0].addEventListener("tap", function () {
    //     // 输入框隐藏,语音开启
    //     mui("#msg-text")[0].style.display = "none";
    //     mui("#msg-sound")[0].style.display = "";
    //     // 语音图标隐藏,输入图框显示
    //     mui("#msg-bars")[0].style.display = ""
    //     mui("#msg-mic")[0].style.display = "none";
    //     // close();
    // });
    // 点击扩展图标需进行操作
    mui("#msg-bars")[0].addEventListener("tap", function () {
        // alert(789);
        // 输入框开启,语音隐藏
        mui("#msg-text")[0].style.display = "";
        mui("#msg-sound")[0].style.display = "none";
        // 扩展标隐藏,语音标显示
        mui("#msg-bars")[0].style.display = "none";
        mui("#msg-mic")[0].style.display = "";
    });
    // 获取焦点发送按钮显示,拍照图标隐藏
    mui("#msg-text")[0].onfocus = function () {
        mui("#msg-send")[0].style.display = "";
        mui("#msg-image")[0].style.display = "none";



    }
    //失去焦点 离开弹框如果内容无长度,则隐藏发送按钮,拍照图标显示
    mui("#msg-text")[0].onblur = function () {
        if (this.value.length == 0) {
            mui("#msg-send")[0].style.display = "none";
            mui("#msg-image")[0].style.display = "";
        }
    }
    //  发送过后,按钮隐藏,拍照图标显示,
    mui("#msg-send")[0].addEventListener("tap", function () {
        var str = $("#msg-text").val();
        $("#msg-2").html(replace_em(str));
        //将数据传递到后台
        button_send(str);
        //将内容显示到界面上
        Question_data(str);

    })


</script>
<script>
    // $(function () {
    //     $('#msg-pengyouquan').qqFace({
    //         id: 'facebox',
    //         assign: 'msg-text',
    //         path: '../../arclist/'	//表情存放的路径
    //     }
    //     );
    //  发送过后, 按钮隐藏, 拍照图标显示
    // $("#msg-send").click(function () {
    //     var str = $("#msg-text").val();
    //     $("#msg-2").html(replace_em(str));
    //     //将数据传递到后台
    //     button_send(str);
    //     //将内容显示到界面上
    //     Question_data(str);
    // });
    // });
    //查看结果
    // function replace_em(str) {
    //     str = str.replace(/\</g, '&lt;');
    //     str = str.replace(/\>/g, '&gt;');
    //     str = str.replace(/\n/g, '<br/>');
    //     str = str.replace(/\[em_([0-9]*)\]/g, '<img src="../../arclist/$1.gif" border="0" />');
    //     return str;
    // }
    //按钮发送执行的操作
    function button_send(str) {
        mui("#msg-send")[0].style.display = "none";
        mui("#msg-image")[0].style.display = "";
        mui("#msg-text")[0].value = "";
        mui("#section_bottom")[0].style.minHeight = '50px';
        $('#content_chat')[0].style.bottom = "50px";
        $('#content_chat')[0].style.paddingTop = "50px";

        mui.post('/index.php/UserlistWxSendOut/', {
            code: code,
            content: str,
            company: $.cookie("company")
        }, function (data) {
            //服务器返回响应，根据响应结果，分析是否登录成功；
        }, 'json'
        );

    }
</script>
<script>


    var content_chat = document.getElementById("content_chat"); //获取内容ID
    // 获取text的数据.将数据发送到界面(提问数据)
    //自己说的话
    function Question_data(data) {
        var div = document.createElement("div") //创造节点
        div.className = "question";
        div.innerHTML = '<div class="right">'
            + '<div class="heard_img">'
            + '<img src="' + $.cookie("headImgUrl") + '">'
            + '</div>'
            + '<div class="question_Name">客服</div>'
            + '</div>'
            + '<div class="question_text clear" style="max-width: 70%;">'
            + '<p>' + replace_em(data) + '</p>'
            + '<i></i>'
            + '</div>'
        content_chat.appendChild(div);
        di();
    }

    var timename = setInterval(function () {
        mui.post('/index.php/UserlistWxChatRecord/', {
            code: code,
            createtime: time,
            company: $.cookie("company")
        }, function (data) {
            if (data.code == 200) {
                if (data.data == "null" || data.data == null) {
                } else {
                    if (data.data.length == 0) {
                    } else {
                        time = data.data[data.data.length - 1].createTime;
                        for (var i = 0; i < data.data.length; i++) {
                            if (data.data[i].toUser == "null" || data.data[i].toUser == null) {
                                //管理员说的话
                                if (kkk) {
                                    Question_data(data.data[i].content);
                                }
                            } else {
                                //用户说的话
                                if (data.data[i].msgType == 'image') {
                                    Answer_data('<img class="Answer_data_img" src="' + data.data[i].img + '" alt="" width="150px">');
                                } else if (data.data[i].msgType == "voice") {
                                    Answer_data('<audio id="myAudio" controls style="width:200px;"><source src="' + data.data[i].voice + '" type="audio/mp3"></audio>')
                                } else {
                                    Answer_data(data.data[i].content);
                                }
                            }

                        }
                        kkk = false;

                    }
                }
            }
            //服务器返回响应，根据响应结果，分析是否登录成功；
        }, 'json'
        );
    }, 100000000);

    //公众号说的话
    // 点击图片放大图片
    mui("#content_chat").on('tap', '.Answer_data_img', function () {
        document.getElementById("picture_div").classList.remove("display");
        document.getElementById("picture_div_img").src = this.src;
    })
    // 关闭图片放大图片
    document.getElementById("picture_div").onclick = function () {
        document.getElementById("picture_div").classList.add("display");
    }
    // Answer_data("天龙盖地虎,宝塔镇河妖");
    function Answer_data(data) {
        if (data == null) {
        } else {
            var div = document.createElement("div") //创造节点
            div.className = "answer";
            div.innerHTML = '<div class="left">'
                + '<div  class="heard_huida">'
                + '<img src="' + localStorage.getItem("data_photo") + '">'
                + '</div>'
                + '<div class="answer_Name">' + localStorage.getItem("username") + '</div>'
                + '</div>'
                + '<div class="answer_text clear" style="max-width: 70%;">'
                + '<p>' + replace_em(data) + '</p>'
                + ' <i></i>'
                + '</div>'
            content_chat.appendChild(div);
        }

    }

    // 苹果手机采用CSS1
    if (/iphone/i.test(navigator.userAgent)) {
        document.body.addEventListener('focusin', () => {
            //软键盘弹起事件 
            close();
            di();
            document.querySelector('#msg-text').scrollIntoView();
        })

        document.body.addEventListener('focusout', () => {
            //软键盘关闭事件 
            document.activeElement.scrollIntoViewIfNeeded(true); // 解决苹果不回弹页面 关键
            // alert("苹果2")
        })

    }

    // // 安卓手机采用CSS2
    // // 安卓手机采用CSS2
    var winHeight = $(window).height();
    if (/android/i.test(navigator.userAgent)) {
        // alert("安卓");
        $(window).resize(function () {
            var thisHeight = $(this).height();
            if (winHeight - thisHeight > 50) {
                //窗口发生改变(大),故此时键盘弹出
                //当软键盘弹出，在这里面操作
                close();
                di()
            } else {

            }
        });

    }

    // mui("#content_chat")[0].addEventListener('tap', function () {
    //     HP = false;
    //     close();
    // })
    //页面滚动到底端
    function di() {
        var scrollHeight = mui('#content_chat')[0].scrollHeight;
        mui('#content_chat')[0].scrollTop = scrollHeight;
    }
    function close() {
        if (document.getElementById("section_bq").classList.contains("display") != true) {
            document.getElementById("section_bq").classList.add('display');
            $('#content_chat')[0].style.bottom = "50px";
            $('#content_chat')[0].style.paddingTop = "50px";
        }
    }
</script>
<script>
    var TB =
        [
            {
                "icon": "/::)",
                "image": "../../arclist/1.gif"
            }, {
                "icon": "/::~",
                "image": "../../arclist/2.gif"
            }, {
                "icon": "/::B",
                "image": "../../arclist/3.gif"
            }, {
                "icon": "/::|",
                "image": "../../arclist/4.gif"
            }, {
                "icon": "/::<",
                "image": "../../arclist/5.gif"
            }, {
                "icon": "/::$",
                "image": "../../arclist/6.gif"
            }, {
                "icon": "/::X",
                "image": "../../arclist/7.gif"
            }, {
                "icon": "/::Z",
                "image": "../../arclist/8.gif"
            }, {
                "icon": "/::'(",
                "image": "../../arclist/9.gif"
            }, {
                "icon": "/::-|",
                "image": "../../arclist/10.gif"
            }, {
                "icon": "/::@",
                "image": "../../arclist/11.gif"
            }, {
                "icon": "/::P",
                "image": "../../arclist/12.gif"
            }, {
                "icon": "/::D",
                "image": "../../arclist/13.gif"
            }, {
                "icon": "/::O",
                "image": "../../arclist/14.gif"
            }, {
                "icon": "/::(",
                "image": "../../arclist/15.gif"
            }, {
                "icon": "Blush",
                "image": "../../arclist/16.gif"
            }, {
                "icon": "/::Q",
                "image": "../../arclist/17.gif"
            }, {
                "icon": "/::T",
                "image": "../../arclist/18.gif"
            }, {
                "icon": "/:,@P",
                "image": "../../arclist/19.gif"
            }, {
                "icon": "/:,@-D",
                "image": "../../arclist/20.gif"
            }, {
                "icon": "/::d",
                "image": "../../arclist/21.gif"
            }, {
                "icon": "/:,@o",
                "image": "../../arclist/22.gif"
            }, {
                "icon": "/::g",
                "image": "../../arclist/23.gif"
            }, {
                "icon": "/:|-)",
                "image": "../../arclist/24.gif"
            }, {
                "icon": "/::!",
                "image": "../../arclist/25.gif"
            }, {
                "icon": "/::L",
                "image": "../../arclist/26.gif"
            }, {
                "icon": "/::>",
                "image": "../../arclist/27.gif"
            }, {
                "icon": "/::,@",
                "image": "../../arclist/28.gif"
            }, {
                "icon": "/:,@f",
                "image": "../../arclist/29.gif"
            }, {
                "icon": "/::-S",
                "image": "../../arclist/30.gif"
            }, {
                "icon": "/:?",
                "image": "../../arclist/31.gif"
            }, {
                "icon": "/:,@x",
                "image": "../../arclist/32.gif"
            }, {
                "icon": "/:,@@",
                "image": "../../arclist/33.gif"
            }, {
                "icon": "/::8",
                "image": "../../arclist/34.gif"
            }, {
                "icon": "/:,@!",
                "image": "../../arclist/35.gif"
            }, {
                "icon": "/:xx",
                "image": "../../arclist/36.gif"
            }, {
                "icon": "/:bye",
                "image": "../../arclist/37.gif"
            }, {
                "icon": "/:wipe",
                "image": "../../arclist/38.gif"
            }, {
                "icon": "/:dig",
                "image": "../../arclist/39.gif"
            }, {
                "icon": "/:&-(",
                "image": "../../arclist/40.gif"
            }, {
                "icon": "/:B-)",
                "image": "../../arclist/41.gif"
            }, {
                "icon": "/:<@",
                "image": "../../arclist/42.gif"
            }, {
                "icon": "/:@>",
                "image": "../../arclist/43.gif"
            }, {
                "icon": "/::-O",
                "image": "../../arclist/44.gif"
            }, {
                "icon": "/:>-|",
                "image": "../../arclist/45.gif"
            }, {
                "icon": "/:P-(",
                "image": "../../arclist/46.gif"
            }, {
                "icon": "/::'|",
                "image": "../../arclist/47.gif"
            }, {
                "icon": "/:X-)",
                "image": "../../arclist/48.gif"
            }, {
                "icon": "/::*",
                "image": "../../arclist/49.gif"
            }, {
                "icon": "/:@x",
                "image": "../../arclist/50.gif"
            }, {
                "icon": "/:8*",
                "image": "../../arclist/51.gif"
            }, {
                "icon": "/:hug",
                "image": "../../arclist/52.gif"
            }, {
                "icon": "/:moon",
                "image": "../../arclist/53.gif"
            }, {
                "icon": "/:sun",
                "image": "../../arclist/54.gif"
            }, {
                "icon": "/:bome",
                "image": "../../arclist/55.gif"
            }, {
                "icon": "/:!!!",
                "image": "../../arclist/56.gif"
            }, {
                "icon": "/:pd",
                "image": "../../arclist/57.gif"
            }, {
                "icon": "/:pig",
                "image": "../../arclist/58.gif"
            }, {
                "icon": "/:<W>",
                "image": "../../arclist/59.gif"
            }, {
                "icon": "/:coffee",
                "image": "../../arclist/60.gif"
            }, {
                "icon": "/:eat",
                "image": "../../arclist/61.gif"
            }, {
                "icon": "/:heart",
                "image": "../../arclist/62.gif"
            }, {
                "icon": "/:strong",
                "image": "../../arclist/63.gif"
            }, {
                "icon": "/:weak",
                "image": "../../arclist/64.gif"
            }, {
                "icon": "/:share",
                "image": "../../arclist/65.gif"
            }, {
                "icon": "/:v",
                "image": "../../arclist/66.gif"
            }, {
                "icon": "/:@)",
                "image": "../../arclist/67.gif"
            }, {
                "icon": "/:jj",
                "image": "../../arclist/68.gif"
            }, {
                "icon": "/:ok",
                "image": "../../arclist/69.gif"
            }, {
                "icon": "/:no",
                "image": "../../arclist/70.gif"
            }, {
                "icon": "/:rose",
                "image": "../../arclist/71.gif"
            }, {
                "icon": "/:fade",
                "image": "../../arclist/72.gif"
            }, {
                "icon": "/:showlove",
                "image": "../../arclist/73.gif"
            }, {
                "icon": "/:love",
                "image": "../../arclist/74.gif"
            }, {
                "icon": "/:<L>",
                "image": "../../arclist/75.gif"
            }

        ]


</script>
</html>